#compdef ark

_ark() {
  local cur
  cur=${words[CURRENT]}

  # If not starting with '-', fallback to default file completion
  if [[ $cur != -* ]]; then
    _files
    return
  fi

  if [[ $cur == --*: ]]; then
    local mainopt="${cur%%:*}"
    local subopts=()
    [[ $mainopt == --g1-pause-time-goal ]] && subopts=(gc-pause-interval max-gc-pause)
    [[ $mainopt == --enable-an ]] && subopts=(force)
    [[ $mainopt == --coroutine-enable-features ]] && subopts=(ani-drain-queue migrate-await migration)
    [[ $mainopt == --list-unhandled-on-exit ]] && subopts=(jobs promises)
    for s in $subopts; do
      compadd -- "$mainopt:$s"
    done
    return
  fi
  local opts
  opts=(--runtime --boot-panda-files --panda-files --boot-intrinsic-spaces --boot-class-spaces --runtime-type --load-runtimes --runtime-compressed-strings-enabled --explicit-concurrent-gc-enabled --run-gc-in-place --full-gc-bombing-frequency --run-gc-every-safepoint --compiler-enable-jit --compiler-hotness-threshold --compiler-profiling-threshold --compiler-enable-osr --debugger-library-path --debugger-enable --sampling-profiler-create --sampling-profiler-startup-run --sampling-profiler-interval --sampling-profiler-output-file --debugger-port --debugger-break-on-start --log-components --compiler-nullcheck --reference-dump --signal-catcher --signal-handler --sigquit-flag --sigusr1-flag --sigusr2-flag --mobile-log-flag --dfx-log --gc-type --ic-enable --gc-trigger-type --log-detailed-gc-info-enabled --log-detailed-gc-compaction-info-enabled --gc-trigger-percent-threshold --gc-trigger-adaptive-multiplier --max-trigger-percent --skip-startup-gc-count --gc-use-nth-alloc-trigger --init-young-space-size --young-space-size --young-shared-space-size --min-extra-heap-size --max-extra-heap-size --gc-debug-trigger-start --gc-dump-heap --gc-workers-count --manage-gc-threads-affinity --use-weak-cpu-for-gc-concurrent --g1-region-garbage-rate-threshold --g1-number-of-tenured-regions-at-mixed-collection --g1-track-freed-objects --gc-marking-stack-new-tasks-frequency --gc-root-marking-stack-max-size --gc-workers-marking-stack-max-size --gc-parallel-marking-enabled --gc-parallel-compacting-enabled --gc-parallel-ref-updating-enabled --g1-single-pass-compaction-enabled --reference-processor-enable --log-level --log-stream --log-file --gc-enable-tracing --g1-enable-concurrent-update-remset --g1-min-concurrent-cards-to-process --g1-hot-cards-processing-frequency --g1-promotion-region-alive-rate --g1-full-gc-region-fragmentation-rate --g1-pause-time-goal --max-gc-pause --gc-pause-interval --distributed-profiling --aot-file --aot-files --aot-verify-abs-path --adaptive-tlab-size --init-tlab-size --max-tlab-size --use-tlab-for-allocations --init-heap-size-limit --heap-size-limit --internal-memory-size-limit --frames-memory-size-limit --min-heap-free-percentage --max-heap-free-percentage --code-cache-size-limit --compiler-memory-size-limit --print-memory-statistics --print-gc-statistics --no-async-jit --compiler-queue-type --compiler-task-life-span --compiler-queue-max-length --compiler-epoch-duration --compiler-death-counter-value --limit-standard-alloc --internal-allocator-type --finalizer-timeout-ms --properties --events-output --events-file --mem-alloc-dump-exec --mem-alloc-dump-file --startup-time --max-free --native-gc-trigger-type --profiler-enabled --profilesaver-sleeping-time-ms --profilesaver-delta-number-threshold --profilesaver-enabled --incremental-profilesaver-enabled --start-as-zygote --verification-mode --verification-update-cache --verification-threads --verification-config-file --verification-cache-file --enable-fast-heap-verifier --heap-verifier --max-global-ref-size --global-reference-size-check-enabled --concurrent-gc-enabled --snapshot-serialize-enabled --snapshot-deserialize-enabled --snapshot-file --framework-abc-file --boot-an-location --enable-an --force --verify-call-stack --safepoint-backtrace --aot-string-gc-roots-limit --resolve-string-aot-threshold --icu-data-path --ark-aot --intrinsics-blacklist --verify-entrypoints --ignore-daemon-memory-leaks-threshold --interpreter-type --abc-layout-profile-location --intrusive-test --profile-output --call-profiling-table-size --coroutine-stack-size-pages --coroutines-stack-mem-limit --use-coroutine-pool --workers-type --taskmanager-workers-count --task-stats-type --load-in-boot --use-string-caches --fail-on-heap-verification --pre-gc-heap-verify-enabled --into-gc-heap-verify-enabled --post-gc-heap-verify-enabled --enable-paralled-young-gc --coroutine-impl --coroutine-workers-count --coroutine-e-workers-limit --coroutine-enable-features --ani-drain-queue --migration --migrate-await --coroutine-dump-stats --taskpool-mode --native-library-path --list-unhandled-on-exit --promises --jobs)
  compadd -Q -a opts
}

compdef _ark ark
